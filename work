<field displayName="Roles" dynamic="true" multi="true" name="roles" postBack="true" required="true" type="string">
  <AllowedValuesDefinition>
    <Script>
      <Source>
        import sailpoint.object.Application;
        import sailpoint.object.Schema;
        import sailpoint.object.EntitlementDefinition;
        import sailpoint.object.Link;

        Application app = context.getObjectByName(Application.class, "Your-App-Name");
        Schema schema = app.getAccountSchema();

        List values = new ArrayList();
        Map entitlementMap = schema.getEntitlements();
        if (entitlementMap != null) {
          for (String key : entitlementMap.keySet()) {
            Collection entitlements = (Collection) entitlementMap.get(key);
            if (entitlements != null) {
              for (Object ent : entitlements) {
                values.add(ent.toString());
              }
            }
          }
        }

        return values;
      </Source>
    </Script>
  </AllowedValuesDefinition>
</field>

Source>
        import sailpoint.object.Application;
        import sailpoint.object.EntitlementDefinition;

        Application app = context.getObjectByName(Application.class, "GLR - GENERAL LEDGER RECONCILIATION COMPLIANCE");

        List values = new ArrayList();

        List entDefs = app.getEntitlementDefinitions();
        for (EntitlementDefinition def : entDefs) {
          if ("entitlement".equals(def.getType())) {
            List ents = def.getValues();
            if (ents != null) {
              for (Object val : ents) {
                values.add(val.toString());
              }
            }
          }
        }

        return values;
